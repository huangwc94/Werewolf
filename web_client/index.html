<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Werewolf Tester</title>
</head>
<script src="/socket.io/socket.io.js"></script>
<script
        src="https://code.jquery.com/jquery-2.2.4.min.js"
        integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
        crossorigin="anonymous"></script>
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
        integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
        crossorigin="anonymous"></script>
<script src='https://code.responsivevoice.org/responsivevoice.js'></script>
<style type="text/css">
    #message {
        margin-top:100px;
        height: 200px;
        overflow: auto;
        overflow-scrolling: auto;
        color: aliceblue;
    }
    body{
        background-color: #000;
    }
    #log {
        text-align: center;
    }

    #reply {
        text-align: center;
    }
    .light{
        font-size: 40px;
        text-align: center;
    }
    #backlog{
        margin-top:100px;
        float: left;
        width: 20%;
        height: 600px;
        overflow: auto;
        position: absolute;
        top:0px;
        left: 0px;
    }
</style>

<body>

<h1 style="text-align: center;color:#fff;background-color: burlywood">Werewolf Web client</h1>
<h3 style="width: 20%;background-color: burlywood">Log</h3>
<div id="backlog">
</div>
<div id="player" class="container">
    <div class="row">
        <div class="client col-md-2" data="1">
            <div class="light">
                <span class="green label label-success">   </span>
                <span class="red label label-danger">   </span>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-info pbtn" data="1"><span class="glyphicon glyphicon-menu-left"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="2"><span class="glyphicon glyphicon-menu-right"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="3"><span class="glyphicon glyphicon-ok"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="4"><span class="glyphicon glyphicon-remove"
                                                                 aria-hidden="true"></span></button>
            </div>
        </div>
        <div class="client col-md-2" data="2">
            <div class="light">
                <span class="green label label-success">   </span>
                <span class="red label label-danger">   </span>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-info pbtn" data="1"><span class="glyphicon glyphicon-menu-left"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="2"><span class="glyphicon glyphicon-menu-right"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="3"><span class="glyphicon glyphicon-ok"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="4"><span class="glyphicon glyphicon-remove"
                                                                 aria-hidden="true"></span></button>
            </div>
        </div>
        <div class="client col-md-2" data="3">
            <div class="light">
                <span class="green label label-success">   </span>
                <span class="red label label-danger">   </span>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-info pbtn" data="1"><span class="glyphicon glyphicon-menu-left"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="2"><span class="glyphicon glyphicon-menu-right"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="3"><span class="glyphicon glyphicon-ok"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="4"><span class="glyphicon glyphicon-remove"
                                                                 aria-hidden="true"></span></button>
            </div>
        </div>
        <div class="client col-md-2" data="4">
            <div class="light">
                <span class="green label label-success">   </span>
                <span class="red label label-danger">   </span>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-info pbtn" data="1"><span class="glyphicon glyphicon-menu-left"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="2"><span class="glyphicon glyphicon-menu-right"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="3"><span class="glyphicon glyphicon-ok"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="4"><span class="glyphicon glyphicon-remove"
                                                                 aria-hidden="true"></span></button>
            </div>
        </div>
        <div class="client col-md-2" data="5">
            <div class="light">
                <span class="green label label-success">   </span>
                <span class="red label label-danger">   </span>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-info pbtn" data="1"><span class="glyphicon glyphicon-menu-left"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="2"><span class="glyphicon glyphicon-menu-right"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="3"><span class="glyphicon glyphicon-ok"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="4"><span class="glyphicon glyphicon-remove"
                                                                 aria-hidden="true"></span></button>
            </div>
        </div>
        <div class="client col-md-2" data="6">
            <div class="light">
                <span class="green label label-success">   </span>
                <span class="red label label-danger">   </span>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-info pbtn" data="1"><span class="glyphicon glyphicon-menu-left"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="2"><span class="glyphicon glyphicon-menu-right"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="3"><span class="glyphicon glyphicon-ok"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="4"><span class="glyphicon glyphicon-remove"
                                                                 aria-hidden="true"></span></button>
            </div>
        </div>
        <div id="log" class="col-md-12">
            <div id="message">

            </div>
        </div>
        <div class="client col-md-2" data="7">
            <div class="light">
                <span class="green label label-success">   </span>
                <span class="red label label-danger">   </span>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-info pbtn" data="1"><span class="glyphicon glyphicon-menu-left"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="2"><span class="glyphicon glyphicon-menu-right"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="3"><span class="glyphicon glyphicon-ok"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="4"><span class="glyphicon glyphicon-remove"
                                                                 aria-hidden="true"></span></button>
            </div>
        </div>
        <div class="client col-md-2" data="8">
            <div class="light">
                <span class="green label label-success">   </span>
                <span class="red label label-danger">   </span>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-info pbtn" data="1"><span class="glyphicon glyphicon-menu-left"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="2"><span class="glyphicon glyphicon-menu-right"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="3"><span class="glyphicon glyphicon-ok"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="4"><span class="glyphicon glyphicon-remove"
                                                                 aria-hidden="true"></span></button>
            </div>
        </div>
        <div class="client col-md-2" data="9">
            <div class="light">
                <span class="green label label-success">   </span>
                <span class="red label label-danger">   </span>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-info pbtn" data="1"><span class="glyphicon glyphicon-menu-left"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="2"><span class="glyphicon glyphicon-menu-right"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="3"><span class="glyphicon glyphicon-ok"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="4"><span class="glyphicon glyphicon-remove"
                                                                 aria-hidden="true"></span></button>
            </div>
        </div>
        <div class="client col-md-2" data="10">
            <div class="light">
                <span class="green label label-success">   </span>
                <span class="red label label-danger">   </span>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-info pbtn" data="1"><span class="glyphicon glyphicon-menu-left"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="2"><span class="glyphicon glyphicon-menu-right"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="3"><span class="glyphicon glyphicon-ok"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="4"><span class="glyphicon glyphicon-remove"
                                                                 aria-hidden="true"></span></button>
            </div>
        </div>
        <div class="client col-md-2" data="11">
            <div class="light">
                <span class="green label label-success">   </span>
                <span class="red label label-danger">   </span>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-info pbtn" data="1"><span class="glyphicon glyphicon-menu-left"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="2"><span class="glyphicon glyphicon-menu-right"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="3"><span class="glyphicon glyphicon-ok"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="4"><span class="glyphicon glyphicon-remove"
                                                                 aria-hidden="true"></span></button>
            </div>
        </div>
        <div class="client col-md-2" data="12">
            <div class="light">
                <span class="green label label-success">   </span>
                <span class="red label label-danger">   </span>
            </div>
            <div class="btn-group" role="group">
                <button class="btn btn-info pbtn" data="1"><span class="glyphicon glyphicon-menu-left"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="2"><span class="glyphicon glyphicon-menu-right"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="3"><span class="glyphicon glyphicon-ok"
                                                                 aria-hidden="true"></span></button>
                <button class="btn btn-info pbtn" data="4"><span class="glyphicon glyphicon-remove"
                                                                 aria-hidden="true"></span></button>
            </div>
        </div>
    </div>

</div>

<div id="reply">
    <h3>Debug</h3>
    <input type="text" class="input" id="mas">
    <button id="send" class="btn btn-danger">Send</button>
</div>
</body>
<script>
    var socket = io();
    socket.on("message", function (e) {
        e = String(e);
        console.log(e);
        if (e.startsWith("GLIGHT")) {
            update_lights("green", e.toString().split(":")[1]);
        } else if (e.startsWith("RLIGHT")) {
            update_lights("red", e.toString().split(":")[1]);
        } else {
            $("#message").html("<h1>" + e + "</h1>");
            $("#backlog").append("<h3>" + e +"</h3>")
            responsiveVoice.speak(e, "US English Female");
        }

    });

    function update_lights(color, data) {
        var d = parseInt(data);
        var class_name = color == "green" ? "label-success" : "label-danger";
        for (var i = 0; i < 12; i++) {
            if ((d & 1 << (i)) > 0) {
                $(".client[data=" + (i+1) + "] ." + color + "").addClass(class_name);
            } else {
                $(".client[data=" + (i+1) + "] ." + color + "").removeClass(class_name);
            }
        }
    }
    $(function () {

        $("#send").click(function () {
            socket.emit("reply", $("#mas").val());
            $("#mas").val("");
        });
        $(".pbtn").each(function (i, v) {
            $(v).click(function () {
                var id = $(this).parent().parent().attr("data");
                var btn = $(this).attr("data");
                socket.emit("reply", [id, btn]);
            })
        });
    });
</script>
</html>